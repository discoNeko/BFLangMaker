<html>
	<head>
		<title>_lang</title>
		<meta charset="utf-8" />
		<link href="https://fonts.googleapis.com/earlyaccess/sawarabimincho.css" rel="stylesheet" />
		<link href="https://fonts.googleapis.com/earlyaccess/mplus1p.css" rel="stylesheet" />
		<style type="text/css">
		<!--
			body {
				font-family: "Sawarabi Mincho";
				margin: auto;
				background-color: #aad;
				text-align: center;
				font-weight: bold;
				color: #336;
			}

			header {
				font-size: 2.5em;
				color: #fff;
				height: 1.5em;
				background-color: #669;
			}

			footer {
				margin: 4em;
			}

			#main {
				font-weight: 400;
				font-size: 1.1em;
				color: #336;
				white-space: nowrap;
			}

			textarea {
				margin: 0.3em;
				height: 8em;
				width: 24em;
				font-weight: 400;
				font-size: 1.2em;
				color: #336;
				border: none;
				background-color: #ddf;
				outline: 0;
			}

			textarea:focus,textarea:hover {
				outline: 3px #969 solid;
			}

			input {
				margin: 0.3em;
				padding-left: 0em;
				height: 2em;
				width: 7em;
				text-indent: 0.5em;
				font-weight: 400;
				font-size: 1em;
				color: #336;
				border-radius: 0.3em;
				background-color: #aad;
				border: 0.2em #669 solid;
				transition: .3s;
			}

			input:focus {
				outline: 0;
			}

			input:hover {
				color: #fff;
				background-color: #669;
			}

			table {
				font-family: "Mplus 1p";
				text-align: center;
				margin-left: auto;
				margin-right: auto;
			}

			.title {
				margin: 0.2em 0;
				font-weight: 700;
				font-size: 1.5em;
			}

			.box {
				margin: 2em 0;
			}
		-->
		</style>
	</head>
	<body>
		<header>
			_lang
		</header>
		<div id="main">
			<div class="box">
				<div class="title">
					ソース
				</div>
				<div>
					<textarea id="src" cols=100 rows=8>_src</textarea>
				</div>
				<div>
					<input type="button" value="実行" onClick="interpreter()" />
					<input type="button" value="クリア" onClick="clear()" />
				</div>
			</div>
			<div class="box">
				<div class="title">
					実行結果
				</div>
				<textarea id="result" cols=100 rows=8></textarea>
			</div>
			<div class="box">
				<div id="pt"></div>
			</div>
			<div class="box">
				<div class="title">
					命令一覧
				</div>
				<table border="1">
					<tr>
						<th>_0</th>
						<td>ポインタを一つ進める。</td>
					</tr>
					<tr>
						<th>_1</th>
						<td>ポインタを一つ戻す。</td>
					</tr>
					<tr>
						<th>_2</th>
						<td>現在ポインタが指している値を出力する。</td>
					</tr>
					<tr>
						<th>_3</th>
						<td>現在ポインタが指している値を1増やす。</td>
					</tr>
					<tr>
						<th>_4</th>
						<td>現在ポインタが指している値を1減らす。</td>
					</tr>
					<tr>
						<th>_5</th>
						<td>ポインタが指している値が0であれば対応する「_6」の位置に進む。</td>
					</tr>
					<tr>
						<th>_6</th>
						<td>ポインタが指している値が0でなければ対応する「_5」の位置に戻る。</td>
					</tr>
				</table>
			</div>
		</div>
		<footer>
			<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://disconeko.github.io/BFLangMaker/" data-text="プログラミング言語：_langを作ったよ！" data-hashtags="BFLangMaker">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
			generated by <a href="https://github.com/discoNeko/BFLangMaker">BFMaker</a>.
		</footer>
	</body>
	<script>
		function clear(){
			var src = document.getElementById('src');
			src.value = "";
		}

		function interpreter(){
			var p = 0;
			var pos = [];
			var tmp = "";
			var src = document.getElementById('src');
			var res = document.getElementById('result');

			tmp = src.value;
			tmp = tmp.replace(new RegExp("_rg0","g"),"_cmd0");
			tmp = tmp.replace(new RegExp("_rg1","g"),"_cmd1");
			tmp = tmp.replace(new RegExp("_rg2","g"),"_cmd2");
			tmp = tmp.replace(new RegExp("_rg3","g"),"_cmd3");
			tmp = tmp.replace(new RegExp("_rg4","g"),"_cmd4");
			tmp = tmp.replace(new RegExp("_rg5","g"),"_cmd5");
			tmp = tmp.replace(new RegExp("_rg6","g"),"_cmd6");
			res.value = "";

			for(var i = 0, len = tmp.length; i < len; i++){
				var key = tmp.charAt(i);
				switch( key ){
					case '>' :
						p++;
						break;
					case '<' :
						p--;
						break;
					case '.' :
						if(!pos[p]){
							pos[p] = 0;
						}
						res.value += String.fromCharCode(pos[p]);
						break;
					case '+' :
						if(!pos[p]){
							pos[p]=0;
						}
						pos[p]++;
						break;
					case '-' :
						if(!pos[p]){
							pos[p] = 0;
						}
						pos[p]--;
						break;
					case '[' :
						if(!pos[p]){
							pos[p]=0;
						}
						if(pos[p] == 0){
							for(var j = i+1; j < len; j++){
								if(tmp.charAt(j) === ']'){
									i = j;
									break;
								}
							}
						}
						break;
					case ']' :
						if(!pos[p]){
							pos[p] = 0;
						}
						if(pos[p] != 0){
							for(var j = i-1; j > 0; j--){
								if(tmp.charAt(j) === '['){
									i = j;
									break;
								}
							}
						}
						break;
				}
			}

			var tbl = "<div class=\"box\"><div class=\"title\">ポインタの値</div><table border=\"1\">";
			for (var k=0 ; k<2 ; k++){
				tbl += "<tr>";
				for (var l=0 ; l<10 ; l++){
					tbl += "<td align=\"center\">p["+k+l+"]</td>";
				}
				tbl += "</tr><tr>";
				for (var l=0 ; l<10 ; l++){
					if(pos[l+k*10]==0){
						tbl += "<td align=\"center\">"+pos[l+k*10]+"</td>";
					}else if(!pos[l+k*10]){
						tbl += "<td align=\"center\"> - </td>";
					}else{
						tbl += "<td align=\"center\">"+pos[l+k*10]+"</td>";
					}
				}
				tbl += "</tr>";
			}
			document.getElementById("pt").innerHTML= tbl + "</table></div>";
		}
	</script>
</html>